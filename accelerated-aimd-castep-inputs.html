<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Castep Input File &mdash; GAP  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/soap.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Si16 - Walkthrough of a Simple Calculation" href="accelerated-aimd_example_Si16.html" />
    <link rel="prev" title="Decision making" href="accelerated-aimd_decision-making.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> GAP
            <img src="_static/soap.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation of QUIP, quippy and GAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="gap_fit.html">The gap_fit program</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">SOAP and GAP reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">GAP models and databases</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="accelerated-aimd.html">Acceleration of Ab-initio MD with On-the-Fly GAP Models</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="accelerated-aimd.html#getting-started-usage">Getting started &amp; Usage</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="accelerated-aimd_installation.html">Installation with CASTEP</a></li>
<li class="toctree-l3"><a class="reference internal" href="accelerated-aimd-input-reference.html">Input file reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="accelerated-aimd_decision-making.html">Decision making</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Castep Input File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#castep-param-file">Castep param file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-castep-v23">Example: Castep v23</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-castep-v22">Example: Castep v22</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="accelerated-aimd.html#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="accelerated-aimd.html#program-structures-and-design">Program structures and design</a></li>
<li class="toctree-l2"><a class="reference internal" href="accelerated-aimd.html#extendability-development">Extendability &amp; Development</a></li>
</ul>
</li>
</ul>

    <p></p>
    <ul>
        <li><a href="genindex.html">Index</a></li>
        <li><a href="py-modindex.html">Module Index</a></li>
<!--        <li><a href="search.html">Search Page</a></li>-->
<!--        <li><a href="_modules/index.html">Module Source Code</a></li>-->
    </ul>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GAP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="accelerated-aimd.html">Acceleration of Ab-initio MD with On-the-Fly GAP Models</a> &raquo;</li>
      <li>Castep Input File</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/accelerated-aimd-castep-inputs.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="castep-input-file">
<h1>Castep Input File<a class="headerlink" href="#castep-input-file" title="Permalink to this heading"></a></h1>
<p>This section is about setting up castep’s inputs to handle the acceleration.</p>
<p>Depending on which version you are using, the parameter names are a little different, see the two examples below.</p>
<section id="castep-param-file">
<h2>Castep param file<a class="headerlink" href="#castep-param-file" title="Permalink to this heading"></a></h2>
<p>The settings governing the acceleration interface are located in the <code class="docutils literal notranslate"><span class="pre">.param</span></code> file’s <code class="docutils literal notranslate"><span class="pre">DEVEL_CODE</span></code> block at
the moment, where the user needs to set a couple of things. However, this can be done once and copied over to
other calculations as-is as long as you keep your <code class="docutils literal notranslate"><span class="pre">hybrid-md</span></code> executable in your path rather than setting it
directly, and keeping the GAP model’s name the same. Otherwise change these two things.</p>
<p>The rest of the parameters listed here are recommendations, which should make your life easy or were found to
be efficient.</p>
<section id="devel-code-block">
<h3>DEVEL_CODE block<a class="headerlink" href="#devel-code-block" title="Permalink to this heading"></a></h3>
<p>Set the following:</p>
<p><code class="docutils literal notranslate"><span class="pre">PP=T</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">MD:</span> <span class="pre">PP=T</span> <span class="pre">:ENDMD</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">PP_HYBRID=T</span></code> which turn of the use of non ab-initio force calculators.</p>
<p>Turn on the usage of QUIP, initialisation arguments of a GAP model, and the path to it. Default is <code class="docutils literal notranslate"><span class="pre">GAP.xml</span></code> so
might just keep it as that.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pp:
    QUIP=T
    QUIP_PARAM_FILE=GAP.xml
    quip_init_args:IP GAP:endquip_init_args
:endpp
</pre></div>
</div>
<p>Finally, set the decision maker program’s path with the <code class="docutils literal notranslate"><span class="pre">PP_HYBRID_EXEC</span></code> block.
This is an “external executable” from Castep’s point of view.</p>
<p><strong>Note on Castep v22:</strong> The code’s initial version was included in Castep’s v22 academic release, where restarting
calculations was not possible yet, and parameter names had an <code class="docutils literal notranslate"><span class="pre">MD_</span></code> prefix. So if you are using v22, please
use <code class="docutils literal notranslate"><span class="pre">MD_PP_HYBRID=T</span></code> for turning on and <code class="docutils literal notranslate"><span class="pre">MD_PP_HYBRID_EXEC</span></code> for the executable.</p>
</section>
<section id="useful-settings-in-param">
<h3>Useful settings in .param<a class="headerlink" href="#useful-settings-in-param" title="Permalink to this heading"></a></h3>
<p>These are educated recommendations only, feel free to overwrite.</p>
<p><code class="docutils literal notranslate"><span class="pre">NUM_BACKUP_ITER</span></code> should be comparable to the number of expected MD steps between ab-initio calculations. This
controls the interval between checkpoints, from where restarting is possible. Anything after the checkpoint is
potentially lost if the job stops and needs restarting.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">continuation:</span> <span class="pre">default</span></code> for continuing a calculation where checkpoints were made and the seed name is the same.
Bear in mind, the MD steps is set to 0 after restart but time is incremented, so the directories with previous
GAP models will have indices accordingly.</p>
<p><code class="docutils literal notranslate"><span class="pre">FINITE_BASIS_CORR:</span> <span class="pre">0</span></code> is recommended. This cannot be done at each ab-initio calculation, and the initial correction
value calculated at the beginning may not be applicable after a long MD run. If you know your system and your simulation
goals do disregard this.</p>
<p>Given that one is intending to use this method for longer MDs, <code class="docutils literal notranslate"><span class="pre">md_sample_iter</span></code> (interval of saving MD frames) should
be adjusted accordingly, since there is some IO cost associated with it as well as disc usage.</p>
<p>Use tight settings on energy and force convergence, since there provide the input data to your model. Worth starting
with looser settings for initial tests and then tightening for production runs.</p>
<p>In case of <strong>variable cell calculations</strong>, make sure to use very dense KPoint grid or tight spacing, otherwise the
training data given to GAP may not be consistent enough between frames and will yield sub-optimal model accuracy.</p>
</section>
</section>
<section id="example-castep-v23">
<h2>Example: Castep v23<a class="headerlink" href="#example-castep-v23" title="Permalink to this heading"></a></h2>
<p>If you are using Castep v23 (academic release only), then then add the following to your <cite>seed.param</cite> file.
Note, the parameter prefixes are <code class="docutils literal notranslate"><span class="pre">MD_PP_HYBRID</span></code> unlike in v23.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>%BLOCK DEVEL_CODE
  ! generally turns on PP, this is needed together with &quot;PP_HYBRID=T&quot;
  PP=T
  MD: PP=T :ENDMD

  ! settings of model called through QUIP
  pp:
      QUIP=T
      QUIP_PARAM_FILE=GAP.xml
      quip_init_args:IP GAP:endquip_init_args
  :endpp

  ! settings of PP Hybrid MD
  PP_HYBRID=T
  PP_HYBRID_EXEC:
    hybrid-md
  :ENDPP_HYBRID_EXEC
%ENDBLOCK DEVEL_CODE
</pre></div>
</div>
</section>
<section id="example-castep-v22">
<h2>Example: Castep v22<a class="headerlink" href="#example-castep-v22" title="Permalink to this heading"></a></h2>
<p>If you are using Castep v22 (academic release only), then then add the following to your <cite>seed.param</cite> file.
Note, the parameter prefixes are <code class="docutils literal notranslate"><span class="pre">MD_PP_HYBRID</span></code> unlike in v23.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>%BLOCK DEVEL_CODE
  ! generally turns on PP, this is needed together with &quot;MD_PP_HYBRID=T&quot;
  PP=T
  MD: PP=T :ENDMD

  ! settings of model called through QUIP
  pp:
      QUIP=T
      QUIP_PARAM_FILE=GAP.xml
      quip_init_args:IP GAP:endquip_init_args
  :endpp

  ! settings of PP Hybrid MD
  MD_PP_HYBRID=T
  MD_PP_HYBRID_EXEC:
    hybrid-md
  :ENDMD_PP_HYBRID_EXEC
%ENDBLOCK DEVEL_CODE
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="accelerated-aimd_decision-making.html" class="btn btn-neutral float-left" title="Decision making" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="accelerated-aimd_example_Si16.html" class="btn btn-neutral float-right" title="Si16 - Walkthrough of a Simple Calculation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2022, Albert Bartok-Partay, Noam Bernstein, Gabor Csanyi and James Kermode.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>