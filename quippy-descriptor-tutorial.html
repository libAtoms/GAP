<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Computing descriptors from python &mdash; GAP  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/soap.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Training a GAP model" href="gap_fitting_tutorial.html" />
    <link rel="prev" title="Using QUIP potentials with Atomic Simulation Environment" href="quippy-potential-tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> GAP
            <img src="_static/soap.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation of QUIP, quippy and GAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="gap_fit.html">The gap_fit program</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quippy-potential-tutorial.html">Using QUIP potentials with Atomic Simulation Environment</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Computing descriptors from python</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#A-simple-descriptor:-pairwise-distances">A simple descriptor: pairwise distances</a></li>
<li class="toctree-l3"><a class="reference internal" href="#A-many-body-descriptor:-SOAP">A many-body descriptor: SOAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#General_monomer-example:-benzene">General_monomer example: benzene</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gap_fitting_tutorial.html">Training a GAP model</a></li>
<li class="toctree-l2"><a class="reference internal" href="gap_si_surface.html">The SOAP descriptor, Gaussian Approximation Potentials (GAP) and machine-learning of force fields</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">SOAP and GAP reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">GAP models and databases</a></li>
</ul>

    <p></p>
    <ul>
        <li><a href="genindex.html">Index</a></li>
        <li><a href="py-modindex.html">Module Index</a></li>
<!--        <li><a href="search.html">Search Page</a></li>-->
<!--        <li><a href="_modules/index.html">Module Source Code</a></li>-->
    </ul>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GAP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="tutorials.html">Tutorials</a> &raquo;</li>
      <li>Computing descriptors from python</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/quippy-descriptor-tutorial.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Computing-descriptors-from-python">
<h1>Computing descriptors from python<a class="headerlink" href="#Computing-descriptors-from-python" title="Permalink to this heading"></a></h1>
<p>This tutorial shows how to use quippy to calculate various descriptors for a given atomic structure, contained in an Atoms object.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">quippy</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">quippy</span> <span class="kn">import</span> <span class="n">descriptors</span>
</pre></div>
</div>
</div>
<p>Create a configuration:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ase</span>
<span class="kn">import</span> <span class="nn">ase.build</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is a two atom structure, not the cubic with 8</span>
<span class="n">at</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">bulk</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">at</span><span class="o">.</span><span class="n">get_positions</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[0.    0.    0.   ]
 [0.875 0.875 0.875]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">at</span><span class="o">.</span><span class="n">get_chemical_symbols</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;C&#39;, &#39;C&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">at</span><span class="o">.</span><span class="n">get_pbc</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ True,  True,  True])
</pre></div></div>
</div>
<p>All descriptors are instantiated by a call to <code class="docutils literal notranslate"><span class="pre">Descriptor()</span></code>, which takes the descriptor initialisation string as its only argument. For a list of available descriptors and their parameters, see the following list, auto-generated using the following command: <code class="docutils literal notranslate"><span class="pre">quip</span> <span class="pre">descriptor_str=&quot;--help&quot;</span></code></p>
<p>bispectrum_so4 bispectrum_so3 behler distance_2b coordination angle_3b co_angle_3b co_distance_2b cosnx trihis water_monomer water_dimer A2_dimer AB_dimer bond_real_space atom_real_space power_so3 power_so4 soap AN_monomer general_monomer general_dimer general_trimer rdf as_distance_2b molecule_lo_d alex com_dimer distance_Nb</p>
<section id="A-simple-descriptor:-pairwise-distances">
<h2>A simple descriptor: pairwise distances<a class="headerlink" href="#A-simple-descriptor:-pairwise-distances" title="Permalink to this heading"></a></h2>
<p>Here we use a simple pair distance between carbon atoms, with a cutoff of 1.5 Angstrom. There are several descriptors that can do this, one is <code class="docutils literal notranslate"><span class="pre">distance_2b</span></code>, which takes a cutoff argument, and two Z values to specify the atom types. Alternatively, the <code class="docutils literal notranslate"><span class="pre">distance_Nb</span></code> descriptor could also do this, with <code class="docutils literal notranslate"><span class="pre">order=2</span></code>, and it takes a string of Zs to specify the atom types. This is more general, <code class="docutils literal notranslate"><span class="pre">order=3</span></code> is a triangle-like three-body descriptor of the three sides of a triangle of 3 atoms.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span> <span class="o">=</span> <span class="n">descriptors</span><span class="o">.</span><span class="n">Descriptor</span><span class="p">(</span><span class="s2">&quot;distance_2b Z1=6 Z2=6 cutoff=4&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The descriptor dimension is the length of the descriptor vector. For the scalar distance this is 1.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span><span class="o">.</span><span class="n">n_dim</span> <span class="c1"># number of dimensions</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1
</pre></div></div>
</div>
<p>This descriptor is very simple: it is scalar (dimension 1), and hence only has a single permutation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span><span class="o">.</span><span class="n">n_perm</span> <span class="c1"># number of permutations</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span><span class="o">.</span><span class="n">permutations</span><span class="p">()</span> <span class="c1"># array of permutation arrays</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[1]], dtype=int32)
</pre></div></div>
</div>
<p>Many descriptors rely on the neighbour connectivity, which is automatically calculated behind the scenes.</p>
<p>We can now calculate how many instances of this descriptor are found in an <code class="docutils literal notranslate"><span class="pre">Atoms</span></code> object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
92
</pre></div></div>
</div>
<p>This also works transparently for iterables (such as lists), returning a list of the counts.</p>
<p>We can also calculate the actual descriptor values – in this case, the list of pairwise distances:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">desc</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;covariance_cutoff&#39;: array([0.30420743, 0.30420743, 0.30420743, 1.        , 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 0.30420743, 0.30420743, 1.        , 1.        ,
        1.        , 1.        , 1.        , 0.30420743, 1.        ,
        1.        , 1.        , 0.30420743, 1.        , 0.30420743,
        1.        , 1.        , 0.30420743, 1.        , 0.30420743,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        0.30420743, 1.        , 1.        , 0.30420743, 1.        ,
        1.        , 0.30420743, 0.30420743, 0.30420743, 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 0.30420743, 0.30420743, 1.        , 1.        ,
        1.        , 0.30420743, 1.        , 1.        , 0.30420743,
        0.30420743, 1.        , 0.30420743, 0.30420743, 1.        ,
        1.        , 0.30420743, 1.        , 0.30420743, 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 1.        ]), &#39;data&#39;: array([[3.81403658],
        [3.81403658],
        [3.81403658],
        [2.90204669],
        [2.90204669],
        [3.5       ],
        [2.90204669],
        [1.51554446],
        [2.47487373],
        [2.90204669],
        [2.47487373],
        [2.90204669],
        [3.5       ],
        [2.90204669],
        [2.47487373],
        [3.5       ],
        [3.81403658],
        [3.81403658],
        [2.90204669],
        [1.51554446],
        [2.47487373],
        [2.90204669],
        [2.47487373],
        [3.81403658],
        [1.51554446],
        [2.47487373],
        [1.51554446],
        [3.81403658],
        [2.47487373],
        [3.81403658],
        [2.90204669],
        [2.47487373],
        [3.81403658],
        [2.47487373],
        [3.81403658],
        [2.90204669],
        [3.5       ],
        [2.90204669],
        [2.47487373],
        [3.5       ],
        [3.81403658],
        [2.90204669],
        [2.47487373],
        [3.81403658],
        [2.47487373],
        [3.5       ],
        [3.81403658],
        [3.81403658],
        [3.81403658],
        [2.90204669],
        [2.90204669],
        [2.90204669],
        [1.51554446],
        [2.90204669],
        [2.90204669],
        [2.90204669],
        [3.81403658],
        [3.81403658],
        [2.90204669],
        [1.51554446],
        [2.90204669],
        [3.81403658],
        [1.51554446],
        [1.51554446],
        [3.81403658],
        [3.81403658],
        [2.90204669],
        [3.81403658],
        [3.81403658],
        [2.90204669],
        [2.90204669],
        [3.81403658],
        [2.90204669],
        [3.81403658],
        [3.5       ],
        [2.47487373],
        [2.47487373],
        [3.5       ],
        [2.47487373],
        [3.5       ],
        [2.47487373],
        [2.47487373],
        [2.47487373],
        [2.47487373],
        [2.47487373],
        [2.47487373],
        [3.5       ],
        [2.47487373],
        [3.5       ],
        [2.47487373],
        [2.47487373],
        [3.5       ]]), &#39;has_data&#39;: array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1])}
</pre></div></div>
</div>
<p>Notice that the first array is called <code class="docutils literal notranslate"><span class="pre">covariance_cutoff</span></code>, and it supplies the value of a cutoff function, implicit in all descriptors, which takes the descriptor value to zero as the atoms approach the cutoff, i.e. in this case as the distance between the two atoms approaches the cutoff. It is more complicated for three-body and higher-body descriptors, but the end result is always a descriptor which changes smoothly with atomic positions.</p>
<p>Here is a histogram of the resulting descriptor array, i.e. of the interatomic distances</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Calculate size of descriptor data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_desc</span><span class="p">,</span> <span class="n">n_cross</span> <span class="o">=</span> <span class="n">desc</span><span class="o">.</span><span class="n">sizes</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n_desc=</span><span class="si">%d</span><span class="s2"> n_cross=</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n_desc</span><span class="p">,</span><span class="n">n_cross</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
n_desc=92 n_cross=184
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">n_desc</span></code> is number of descriptors, <code class="docutils literal notranslate"><span class="pre">n_cross</span></code> is number of gradients</p>
<p>Gradients are returned in a <code class="docutils literal notranslate"><span class="pre">Dictionary</span></code> object ( if the <code class="docutils literal notranslate"><span class="pre">grad=True</span></code> option is set ) which has the following elements: - <code class="docutils literal notranslate"><span class="pre">data</span></code> = the descriptor values (equivalent to <code class="docutils literal notranslate"><span class="pre">desc.calc(at)</span></code>) # earlier <code class="docutils literal notranslate"><span class="pre">descriptor</span></code> - <code class="docutils literal notranslate"><span class="pre">grad_data</span></code> = the gradients # earlier <code class="docutils literal notranslate"><span class="pre">grad</span></code> - <code class="docutils literal notranslate"><span class="pre">ii</span></code> = the indices (<code class="docutils literal notranslate"><span class="pre">i_desc</span></code>, <code class="docutils literal notranslate"><span class="pre">i_atom</span></code>, <code class="docutils literal notranslate"><span class="pre">i_coord</span></code>) # this was <code class="docutils literal notranslate"><span class="pre">index</span></code>, right?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">desc</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">at</span><span class="p">,</span> <span class="n">grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">list</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;has_grad_data&#39;,
 &#39;ii&#39;,
 &#39;pos&#39;,
 &#39;grad_covariance_cutoff&#39;,
 &#39;covariance_cutoff&#39;,
 &#39;data&#39;,
 &#39;has_data&#39;,
 &#39;grad_data&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][:,:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[3.81403658],
       [3.81403658],
       [3.81403658],
       [2.90204669],
       [2.90204669],
       [3.5       ],
       [2.90204669],
       [1.51554446],
       [2.47487373],
       [2.90204669],
       [2.47487373],
       [2.90204669],
       [3.5       ],
       [2.90204669],
       [2.47487373],
       [3.5       ],
       [3.81403658],
       [3.81403658],
       [2.90204669],
       [1.51554446],
       [2.47487373],
       [2.90204669],
       [2.47487373],
       [3.81403658],
       [1.51554446],
       [2.47487373],
       [1.51554446],
       [3.81403658],
       [2.47487373],
       [3.81403658],
       [2.90204669],
       [2.47487373],
       [3.81403658],
       [2.47487373],
       [3.81403658],
       [2.90204669],
       [3.5       ],
       [2.90204669],
       [2.47487373],
       [3.5       ],
       [3.81403658],
       [2.90204669],
       [2.47487373],
       [3.81403658],
       [2.47487373],
       [3.5       ],
       [3.81403658],
       [3.81403658],
       [3.81403658],
       [2.90204669],
       [2.90204669],
       [2.90204669],
       [1.51554446],
       [2.90204669],
       [2.90204669],
       [2.90204669],
       [3.81403658],
       [3.81403658],
       [2.90204669],
       [1.51554446],
       [2.90204669],
       [3.81403658],
       [1.51554446],
       [1.51554446],
       [3.81403658],
       [3.81403658],
       [2.90204669],
       [3.81403658],
       [3.81403658],
       [2.90204669],
       [2.90204669],
       [3.81403658],
       [2.90204669],
       [3.81403658],
       [3.5       ],
       [2.47487373],
       [2.47487373],
       [3.5       ],
       [2.47487373],
       [3.5       ],
       [2.47487373],
       [2.47487373],
       [2.47487373],
       [2.47487373],
       [2.47487373],
       [2.47487373],
       [3.5       ],
       [2.47487373],
       [3.5       ],
       [2.47487373],
       [2.47487373],
       [3.5       ]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;grad_data&#39;</span><span class="p">][:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">res</span><span class="p">[</span><span class="s1">&#39;grad_data&#39;</span><span class="p">][:,:</span><span class="mi">10</span><span class="p">]</span> <span class="c1">#this is outputted as a verly long thing</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(184, 3, 1)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[[ 0.6882472 ],
        [ 0.6882472 ],
        [-0.22941573]],

       [[-0.6882472 ],
        [-0.6882472 ],
        [ 0.22941573]],

       [[ 0.6882472 ],
        [ 0.22941573],
        [-0.6882472 ]],

       [[-0.6882472 ],
        [-0.22941573],
        [ 0.6882472 ]],

       [[ 0.22941573],
        [ 0.6882472 ],
        [-0.6882472 ]],

       [[-0.22941573],
        [-0.6882472 ],
        [ 0.6882472 ]],

       [[ 0.90453403],
        [ 0.30151134],
        [ 0.30151134]],

       [[-0.90453403],
        [-0.30151134],
        [-0.30151134]],

       [[ 0.90453403],
        [-0.30151134],
        [-0.30151134]],

       [[-0.90453403],
        [ 0.30151134],
        [ 0.30151134]],

       [[ 1.        ],
        [-0.        ],
        [-0.        ]],

       [[-1.        ],
        [ 0.        ],
        [ 0.        ]],

       [[ 0.30151134],
        [ 0.90453403],
        [ 0.30151134]],

       [[-0.30151134],
        [-0.90453403],
        [-0.30151134]],

       [[ 0.57735027],
        [ 0.57735027],
        [-0.57735027]],

       [[-0.57735027],
        [-0.57735027],
        [ 0.57735027]],

       [[ 0.70710678],
        [ 0.70710678],
        [-0.        ]],

       [[-0.70710678],
        [-0.70710678],
        [ 0.        ]],

       [[ 0.30151134],
        [-0.30151134],
        [-0.90453403]],

       [[-0.30151134],
        [ 0.30151134],
        [ 0.90453403]],

       [[ 0.70710678],
        [-0.        ],
        [-0.70710678]],

       [[-0.70710678],
        [ 0.        ],
        [ 0.70710678]],

       [[-0.30151134],
        [ 0.90453403],
        [-0.30151134]],

       [[ 0.30151134],
        [-0.90453403],
        [ 0.30151134]],

       [[-0.        ],
        [ 1.        ],
        [-0.        ]],

       [[ 0.        ],
        [-1.        ],
        [ 0.        ]],

       [[-0.30151134],
        [ 0.30151134],
        [-0.90453403]],

       [[ 0.30151134],
        [-0.30151134],
        [ 0.90453403]],

       [[-0.        ],
        [ 0.70710678],
        [-0.70710678]],

       [[ 0.        ],
        [-0.70710678],
        [ 0.70710678]],

       [[-0.        ],
        [-0.        ],
        [-1.        ]],

       [[ 0.        ],
        [ 0.        ],
        [ 1.        ]],

       [[ 0.6882472 ],
        [-0.22941573],
        [ 0.6882472 ]],

       [[-0.6882472 ],
        [ 0.22941573],
        [-0.6882472 ]],

       [[ 0.6882472 ],
        [-0.6882472 ],
        [ 0.22941573]],

       [[-0.6882472 ],
        [ 0.6882472 ],
        [-0.22941573]],

       [[ 0.30151134],
        [ 0.30151134],
        [ 0.90453403]],

       [[-0.30151134],
        [-0.30151134],
        [-0.90453403]],

       [[ 0.57735027],
        [-0.57735027],
        [ 0.57735027]],

       [[-0.57735027],
        [ 0.57735027],
        [-0.57735027]],

       [[ 0.70710678],
        [-0.        ],
        [ 0.70710678]],

       [[-0.70710678],
        [ 0.        ],
        [-0.70710678]],

       [[ 0.30151134],
        [-0.90453403],
        [-0.30151134]],

       [[-0.30151134],
        [ 0.90453403],
        [ 0.30151134]],

       [[ 0.70710678],
        [-0.70710678],
        [-0.        ]],

       [[-0.70710678],
        [ 0.70710678],
        [ 0.        ]],

       [[-0.22941573],
        [ 0.6882472 ],
        [ 0.6882472 ]],

       [[ 0.22941573],
        [-0.6882472 ],
        [-0.6882472 ]],

       [[-0.57735027],
        [ 0.57735027],
        [ 0.57735027]],

       [[ 0.57735027],
        [-0.57735027],
        [-0.57735027]],

       [[-0.        ],
        [ 0.70710678],
        [ 0.70710678]],

       [[ 0.        ],
        [-0.70710678],
        [-0.70710678]],

       [[-0.57735027],
        [-0.57735027],
        [-0.57735027]],

       [[ 0.57735027],
        [ 0.57735027],
        [ 0.57735027]],

       [[-0.22941573],
        [-0.6882472 ],
        [-0.6882472 ]],

       [[ 0.22941573],
        [ 0.6882472 ],
        [ 0.6882472 ]],

       [[-0.        ],
        [-0.70710678],
        [-0.70710678]],

       [[ 0.        ],
        [ 0.70710678],
        [ 0.70710678]],

       [[-0.6882472 ],
        [ 0.6882472 ],
        [ 0.22941573]],

       [[ 0.6882472 ],
        [-0.6882472 ],
        [-0.22941573]],

       [[-0.90453403],
        [ 0.30151134],
        [-0.30151134]],

       [[ 0.90453403],
        [-0.30151134],
        [ 0.30151134]],

       [[-0.70710678],
        [ 0.70710678],
        [-0.        ]],

       [[ 0.70710678],
        [-0.70710678],
        [ 0.        ]],

       [[-0.6882472 ],
        [-0.22941573],
        [-0.6882472 ]],

       [[ 0.6882472 ],
        [ 0.22941573],
        [ 0.6882472 ]],

       [[-0.70710678],
        [-0.        ],
        [-0.70710678]],

       [[ 0.70710678],
        [ 0.        ],
        [ 0.70710678]],

       [[ 0.22941573],
        [-0.6882472 ],
        [ 0.6882472 ]],

       [[-0.22941573],
        [ 0.6882472 ],
        [-0.6882472 ]],

       [[-0.30151134],
        [-0.30151134],
        [ 0.90453403]],

       [[ 0.30151134],
        [ 0.30151134],
        [-0.90453403]],

       [[-0.        ],
        [-0.        ],
        [ 1.        ]],

       [[ 0.        ],
        [ 0.        ],
        [-1.        ]],

       [[-0.30151134],
        [-0.90453403],
        [ 0.30151134]],

       [[ 0.30151134],
        [ 0.90453403],
        [-0.30151134]],

       [[-0.        ],
        [-0.70710678],
        [ 0.70710678]],

       [[ 0.        ],
        [ 0.70710678],
        [-0.70710678]],

       [[-0.        ],
        [-1.        ],
        [-0.        ]],

       [[ 0.        ],
        [ 1.        ],
        [ 0.        ]],

       [[-0.6882472 ],
        [ 0.22941573],
        [ 0.6882472 ]],

       [[ 0.6882472 ],
        [-0.22941573],
        [-0.6882472 ]],

       [[-0.90453403],
        [-0.30151134],
        [ 0.30151134]],

       [[ 0.90453403],
        [ 0.30151134],
        [-0.30151134]],

       [[-0.70710678],
        [-0.        ],
        [ 0.70710678]],

       [[ 0.70710678],
        [ 0.        ],
        [-0.70710678]],

       [[-0.6882472 ],
        [-0.6882472 ],
        [-0.22941573]],

       [[ 0.6882472 ],
        [ 0.6882472 ],
        [ 0.22941573]],

       [[-0.70710678],
        [-0.70710678],
        [-0.        ]],

       [[ 0.70710678],
        [ 0.70710678],
        [ 0.        ]],

       [[-1.        ],
        [-0.        ],
        [-0.        ]],

       [[ 1.        ],
        [ 0.        ],
        [ 0.        ]],

       [[-0.6882472 ],
        [-0.6882472 ],
        [ 0.22941573]],

       [[ 0.6882472 ],
        [ 0.6882472 ],
        [-0.22941573]],

       [[-0.6882472 ],
        [-0.22941573],
        [ 0.6882472 ]],

       [[ 0.6882472 ],
        [ 0.22941573],
        [-0.6882472 ]],

       [[-0.22941573],
        [-0.6882472 ],
        [ 0.6882472 ]],

       [[ 0.22941573],
        [ 0.6882472 ],
        [-0.6882472 ]],

       [[-0.90453403],
        [-0.30151134],
        [-0.30151134]],

       [[ 0.90453403],
        [ 0.30151134],
        [ 0.30151134]],

       [[-0.90453403],
        [ 0.30151134],
        [ 0.30151134]],

       [[ 0.90453403],
        [-0.30151134],
        [-0.30151134]],

       [[-0.30151134],
        [-0.90453403],
        [-0.30151134]],

       [[ 0.30151134],
        [ 0.90453403],
        [ 0.30151134]],

       [[-0.57735027],
        [-0.57735027],
        [ 0.57735027]],

       [[ 0.57735027],
        [ 0.57735027],
        [-0.57735027]],

       [[-0.30151134],
        [ 0.30151134],
        [ 0.90453403]],

       [[ 0.30151134],
        [-0.30151134],
        [-0.90453403]],

       [[ 0.30151134],
        [-0.90453403],
        [ 0.30151134]],

       [[-0.30151134],
        [ 0.90453403],
        [-0.30151134]],

       [[ 0.30151134],
        [-0.30151134],
        [ 0.90453403]],

       [[-0.30151134],
        [ 0.30151134],
        [-0.90453403]],

       [[-0.6882472 ],
        [ 0.22941573],
        [-0.6882472 ]],

       [[ 0.6882472 ],
        [-0.22941573],
        [ 0.6882472 ]],

       [[-0.6882472 ],
        [ 0.6882472 ],
        [-0.22941573]],

       [[ 0.6882472 ],
        [-0.6882472 ],
        [ 0.22941573]],

       [[-0.30151134],
        [-0.30151134],
        [-0.90453403]],

       [[ 0.30151134],
        [ 0.30151134],
        [ 0.90453403]],

       [[-0.57735027],
        [ 0.57735027],
        [-0.57735027]],

       [[ 0.57735027],
        [-0.57735027],
        [ 0.57735027]],

       [[-0.30151134],
        [ 0.90453403],
        [ 0.30151134]],

       [[ 0.30151134],
        [-0.90453403],
        [-0.30151134]],

       [[ 0.22941573],
        [-0.6882472 ],
        [-0.6882472 ]],

       [[-0.22941573],
        [ 0.6882472 ],
        [ 0.6882472 ]],

       [[ 0.57735027],
        [-0.57735027],
        [-0.57735027]],

       [[-0.57735027],
        [ 0.57735027],
        [ 0.57735027]],

       [[ 0.57735027],
        [ 0.57735027],
        [ 0.57735027]],

       [[-0.57735027],
        [-0.57735027],
        [-0.57735027]],

       [[ 0.22941573],
        [ 0.6882472 ],
        [ 0.6882472 ]],

       [[-0.22941573],
        [-0.6882472 ],
        [-0.6882472 ]],

       [[ 0.6882472 ],
        [-0.6882472 ],
        [-0.22941573]],

       [[-0.6882472 ],
        [ 0.6882472 ],
        [ 0.22941573]],

       [[ 0.90453403],
        [-0.30151134],
        [ 0.30151134]],

       [[-0.90453403],
        [ 0.30151134],
        [-0.30151134]],

       [[ 0.6882472 ],
        [ 0.22941573],
        [ 0.6882472 ]],

       [[-0.6882472 ],
        [-0.22941573],
        [-0.6882472 ]],

       [[-0.22941573],
        [ 0.6882472 ],
        [-0.6882472 ]],

       [[ 0.22941573],
        [-0.6882472 ],
        [ 0.6882472 ]],

       [[ 0.30151134],
        [ 0.30151134],
        [-0.90453403]],

       [[-0.30151134],
        [-0.30151134],
        [ 0.90453403]],

       [[ 0.30151134],
        [ 0.90453403],
        [-0.30151134]],

       [[-0.30151134],
        [-0.90453403],
        [ 0.30151134]],

       [[ 0.6882472 ],
        [-0.22941573],
        [-0.6882472 ]],

       [[-0.6882472 ],
        [ 0.22941573],
        [ 0.6882472 ]],

       [[ 0.90453403],
        [ 0.30151134],
        [-0.30151134]],

       [[-0.90453403],
        [-0.30151134],
        [ 0.30151134]],

       [[ 0.6882472 ],
        [ 0.6882472 ],
        [ 0.22941573]],

       [[-0.6882472 ],
        [-0.6882472 ],
        [-0.22941573]],

       [[ 1.        ],
        [-0.        ],
        [-0.        ]],

       [[-1.        ],
        [ 0.        ],
        [ 0.        ]],

       [[ 0.70710678],
        [ 0.70710678],
        [-0.        ]],

       [[-0.70710678],
        [-0.70710678],
        [ 0.        ]],

       [[ 0.70710678],
        [-0.        ],
        [-0.70710678]],

       [[-0.70710678],
        [ 0.        ],
        [ 0.70710678]],

       [[-0.        ],
        [ 1.        ],
        [-0.        ]],

       [[ 0.        ],
        [-1.        ],
        [ 0.        ]],

       [[-0.        ],
        [ 0.70710678],
        [-0.70710678]],

       [[ 0.        ],
        [-0.70710678],
        [ 0.70710678]],

       [[-0.        ],
        [-0.        ],
        [-1.        ]],

       [[ 0.        ],
        [ 0.        ],
        [ 1.        ]],

       [[ 0.70710678],
        [-0.        ],
        [ 0.70710678]],

       [[-0.70710678],
        [ 0.        ],
        [-0.70710678]],

       [[ 0.70710678],
        [-0.70710678],
        [-0.        ]],

       [[-0.70710678],
        [ 0.70710678],
        [ 0.        ]],

       [[-0.        ],
        [ 0.70710678],
        [ 0.70710678]],

       [[ 0.        ],
        [-0.70710678],
        [-0.70710678]],

       [[-0.        ],
        [-0.70710678],
        [-0.70710678]],

       [[ 0.        ],
        [ 0.70710678],
        [ 0.70710678]],

       [[-0.70710678],
        [ 0.70710678],
        [-0.        ]],

       [[ 0.70710678],
        [-0.70710678],
        [ 0.        ]],

       [[-0.70710678],
        [-0.        ],
        [-0.70710678]],

       [[ 0.70710678],
        [ 0.        ],
        [ 0.70710678]],

       [[-0.        ],
        [-0.        ],
        [ 1.        ]],

       [[ 0.        ],
        [ 0.        ],
        [-1.        ]],

       [[-0.        ],
        [-0.70710678],
        [ 0.70710678]],

       [[ 0.        ],
        [ 0.70710678],
        [-0.70710678]],

       [[-0.        ],
        [-1.        ],
        [-0.        ]],

       [[ 0.        ],
        [ 1.        ],
        [ 0.        ]],

       [[-0.70710678],
        [-0.        ],
        [ 0.70710678]],

       [[ 0.70710678],
        [ 0.        ],
        [-0.70710678]],

       [[-0.70710678],
        [-0.70710678],
        [-0.        ]],

       [[ 0.70710678],
        [ 0.70710678],
        [ 0.        ]],

       [[-1.        ],
        [-0.        ],
        [-0.        ]],

       [[ 1.        ],
        [ 0.        ],
        [ 0.        ]]])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this does not even work with the latest py2...</span>
<span class="c1"># res.index[:,:10]</span>
</pre></div>
</div>
</div>
</section>
<section id="A-many-body-descriptor:-SOAP">
<h2>A many-body descriptor: SOAP<a class="headerlink" href="#A-many-body-descriptor:-SOAP" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span> <span class="o">=</span> <span class="n">descriptors</span><span class="o">.</span><span class="n">Descriptor</span><span class="p">(</span><span class="s2">&quot;soap cutoff=3 l_max=4 n_max=4 atom_sigma=0.5 n_Z=1 Z=</span><span class="si">{6}</span><span class="s2"> &quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># at.set_cutoff(desc.cutoff())</span>
<span class="c1"># at.calc_connect()</span>
</pre></div>
</div>
</div>
<p>There are now only 8 descriptors, because SOAP produces one for each atom in the structure</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span><span class="o">.</span><span class="n">sizes</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2, 58)
</pre></div></div>
</div>
<p>But each descriptor now is a long vector, because it encodes the entire environment of the atom up to the cutoff. The length of the vector depends on <code class="docutils literal notranslate"><span class="pre">l_max</span></code> and <code class="docutils literal notranslate"><span class="pre">n_max</span></code> and also on the number of atom types.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span><span class="o">.</span><span class="n">n_dim</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
51
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;covariance_cutoff&#39;: array([1., 1.]),
 &#39;data&#39;: array([[ 2.63487898e-01,  4.88846681e-35,  4.70073620e-36,
          2.27467236e-03,  7.81144539e-04,  5.51080842e-01,
         -2.80880401e-35, -1.00070027e-34,  2.19176356e-02,
          7.81338076e-03,  5.76288508e-01,  1.95207652e-33,
          2.57768609e-33,  1.05593834e-01,  3.90765830e-02,
          2.84225658e-01, -2.98268236e-34,  2.34728485e-37,
         -2.01220340e-03,  2.59681991e-03,  4.20342133e-01,
         -4.06607819e-34,  2.35117001e-34, -1.37098193e-02,
          1.83668391e-02,  1.53297789e-01,  1.25598722e-33,
          4.10252085e-35,  8.90010050e-04,  4.31640581e-03,
         -2.51452500e-03, -9.71796031e-37,  2.44522012e-38,
          1.63990654e-05, -2.38148142e-05, -3.71873816e-03,
          1.08673965e-35, -2.31968275e-36,  1.11732355e-04,
         -1.68437888e-04, -1.91797776e-03,  2.17347930e-36,
          1.57834671e-37, -1.02578685e-05, -5.59812552e-05,
          1.19983423e-05,  3.78678845e-38,  8.02754752e-39,
          5.91138644e-08,  3.63022045e-07,  0.00000000e+00],
        [ 2.63487898e-01,  7.09330130e-36,  4.94500281e-36,
          2.27467236e-03,  7.81144539e-04,  5.51080842e-01,
         -5.35010288e-35,  4.97300625e-35,  2.19176356e-02,
          7.81338076e-03,  5.76288508e-01,  3.17779898e-34,
          2.52011995e-34,  1.05593834e-01,  3.90765830e-02,
          2.84225658e-01,  3.21006173e-35,  0.00000000e+00,
         -2.01220340e-03,  2.59681991e-03,  4.20342133e-01,
         -2.56804938e-34,  0.00000000e+00, -1.37098193e-02,
          1.83668391e-02,  1.53297789e-01,  1.21059009e-34,
          0.00000000e+00,  8.90010050e-04,  4.31640581e-03,
         -2.51452500e-03, -8.35953575e-38,  0.00000000e+00,
          1.63990654e-05, -2.38148142e-05, -3.71873816e-03,
         -3.34381430e-37,  0.00000000e+00,  1.11732355e-04,
         -1.68437888e-04, -1.91797776e-03,  0.00000000e+00,
          0.00000000e+00, -1.02578685e-05, -5.59812552e-05,
          1.19983423e-05,  3.69442776e-39,  0.00000000e+00,
          5.91138644e-08,  3.63022045e-07,  0.00000000e+00]]),
 &#39;has_data&#39;: array([1, 1])}
</pre></div></div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">cutoff</span></code> array is now all 1, because SOAP takes the cutoff into account when it computes the descriptor vector</p>
<p>We now add a hydrogen atom to the structure</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># at.add_atoms((0.2,0.2,0.2),(1))</span>
<span class="n">at</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ase</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># at.calc_connect()</span>
<span class="n">desc</span><span class="o">.</span><span class="n">sizes</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2, 84)
</pre></div></div>
</div>
<p>The descriptor sizes did not change! This is because the descriptor was set up above to only look at carbon atoms (Z=6). We need a new descriptor that takes account of H atoms.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span> <span class="o">=</span> <span class="n">descriptors</span><span class="o">.</span><span class="n">Descriptor</span><span class="p">(</span><span class="s2">&quot;soap cutoff=3 l_max=4 n_max=4 atom_sigma=0.5 n_Z=2 Z={1 6} n_species=2 species_Z={1 6}&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The specification of which atoms are used as SOAP centers is separate to the specification of which atoms are taken into account in the environment. The <code class="docutils literal notranslate"><span class="pre">n_Z=2</span> <span class="pre">Z={1</span> <span class="pre">6}</span></code> options specify that both H and C are to be taken as SOAP centers. The <code class="docutils literal notranslate"><span class="pre">n_species=2</span> <span class="pre">species_Z={1</span> <span class="pre">6}</span></code> options specify the atom types to be taken into account in the environment.</p>
<p>Now the dimensionality of the SOAP descriptor goes up:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span><span class="o">.</span><span class="n">n_dim</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
181
</pre></div></div>
</div>
<p>And the size also increases to 9 (and the cross terms go up too), reflecting the fact that there are 9 atoms altogether.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span><span class="o">.</span><span class="n">sizes</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3, 123)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;covariance_cutoff&#39;: array([1., 1., 1.]),
 &#39;data&#39;: array([[ 9.33322279e-02,  1.08024682e-04,  4.43873210e-06,
          1.57881914e-05,  4.16237446e-05,  1.02738757e-01,
          9.69937759e-04,  3.35597718e-05,  1.56436845e-04,
          4.25163207e-04,  5.65466638e-02,  4.35446438e-03,
          1.26867117e-04,  7.77168436e-04,  2.19193921e-03,
          1.06926399e-01, -9.09191244e-04, -1.09555484e-04,
          3.54608882e-05,  2.39572569e-04,  8.32286056e-02,
         -5.77246248e-03, -5.85705351e-04,  2.83218039e-04,
          2.06349068e-03,  6.12503048e-02,  3.82611041e-03,
          1.35200818e-03,  3.21785045e-04,  3.39125126e-03,
         -9.52478353e-04,  7.83266259e-06,  1.02663823e-06,
         -3.50961837e-07, -2.10019423e-06, -7.41383287e-04,
          4.97296374e-05,  5.48861164e-06, -2.78291927e-06,
         -1.81482425e-05, -7.71602143e-04, -4.66151054e-05,
         -1.79175088e-05, -4.27301110e-06, -4.27179169e-05,
          4.86013799e-06,  2.83965675e-07,  1.18726028e-07,
          2.83825414e-08,  2.69065369e-07,  1.97091938e-01,
         -6.36235164e-20, -2.67092939e-21,  8.79900409e-05,
          1.69491950e-04,  1.53411013e-01, -4.03946214e-19,
         -1.42793183e-20,  5.34939158e-04,  1.32986131e-03,
          1.59664061e-01,  3.78647349e-19,  4.66146683e-20,
         -7.95581905e-04,  1.90184303e-03, -1.42225459e-03,
         -3.26203859e-21, -4.36823414e-22,  7.33235928e-06,
         -1.68863366e-05,  2.08101921e-01,  3.86089587e-35,
          3.71262682e-36,  1.79652915e-03,  6.16945525e-04,
          2.91479827e-01,  3.61256782e-19,  7.16777694e-20,
          5.99505777e-04,  1.19878601e-03,  2.26879982e-01,
          2.29362220e-18,  3.83203573e-19,  3.64472061e-03,
          9.40586935e-03,  2.36127633e-01, -2.14997426e-18,
         -1.25096360e-18, -5.42056741e-03,  1.34513929e-02,
         -2.10337635e-03,  1.85219810e-20,  1.17227090e-20,
          4.99578328e-05, -1.19434015e-04,  4.35241934e-01,
         -2.21838467e-35, -7.90349958e-35,  1.73104804e-02,
          6.17098380e-03,  4.55150870e-01,  1.54174396e-33,
          2.03584845e-33,  8.33976811e-02,  3.08625637e-02,
          1.50333743e-01,  1.19436062e-19, -3.70099011e-21,
         -5.50391286e-05,  3.98423101e-04,  1.17015703e-01,
          7.58300515e-19, -1.97862272e-20, -3.34612699e-04,
          3.12609222e-03,  1.21785275e-01, -7.10808690e-19,
          6.45919085e-20,  4.97648760e-04,  4.47064416e-03,
         -1.08483816e-03,  6.12360125e-21, -6.05287112e-22,
         -4.58650389e-06, -3.96945494e-05,  2.24480540e-01,
         -2.35571324e-34,  1.85387827e-37, -1.58923198e-03,
          2.05096028e-03,  3.31984908e-01, -3.21137590e-34,
          1.85694676e-34, -1.08279726e-02,  1.45060724e-02,
          1.21074117e-01,  9.91974795e-34,  3.24015820e-35,
          7.02927168e-04,  3.40908387e-03, -1.32999236e-03,
          2.17403929e-21, -2.18662013e-22,  4.48558168e-07,
         -3.65384295e-06, -1.03522994e-03,  1.38029929e-20,
         -1.16901050e-21,  2.72702827e-06, -2.86686440e-05,
         -1.07742601e-03, -1.29385212e-20,  3.81622116e-21,
         -4.05574038e-06, -4.09992082e-05,  9.59748916e-06,
          1.11465076e-22, -3.57615921e-23,  3.73791126e-08,
          3.64029218e-07, -1.98596402e-03, -7.67521481e-37,
          1.93122724e-38,  1.29519308e-05, -1.88088662e-05,
         -2.93704783e-03,  8.58303591e-36, -1.83207822e-36,
          8.82458661e-05, -1.33031720e-04, -1.51481287e-03,
          1.71660718e-36,  1.24657332e-37, -8.10163264e-06,
         -4.42138211e-05,  9.47625339e-06,  2.99079374e-38,
          6.34013204e-39,  4.66879461e-08,  2.86713682e-07,
          0.00000000e+00],
        [ 7.93376086e-03,  8.90122094e-05,  7.47579654e-05,
          1.16384995e-03,  4.18412970e-04,  5.55996090e-02,
          7.80748554e-04,  6.80346872e-04,  1.10274857e-02,
          4.07471822e-03,  1.94820374e-01,  3.42407131e-03,
          3.09580300e-03,  5.22611967e-02,  1.98470986e-02,
          1.66673235e-02, -9.61119773e-04, -5.24749884e-04,
         -3.17217034e-03,  1.24175412e-04,  8.25930489e-02,
         -5.96106863e-03, -3.37683836e-03, -2.09537864e-02,
          9.56633109e-04,  1.75074392e-02,  5.18890175e-03,
          1.84169298e-03,  6.75008315e-03,  8.41972741e-04,
         -1.45254896e-04,  8.38160521e-06,  4.57369912e-06,
          2.76196303e-05, -1.09819746e-06, -7.19794318e-04,
          5.19844928e-05,  2.94323889e-05,  1.82436714e-04,
         -8.44579542e-06, -2.15775703e-04, -6.39941293e-05,
         -2.27011298e-05, -8.31721969e-05, -1.03633484e-05,
          1.32969630e-06,  3.94616123e-07,  1.39909664e-07,
          5.12409979e-07,  6.37785595e-08,  5.68770314e-02,
          1.93011899e-21, -1.12751618e-20,  2.01740714e-03,
          5.52437272e-04,  2.81847739e-01,  1.19710073e-20,
         -7.25572316e-20,  1.35369634e-02,  3.74939114e-03,
          8.44906559e-02, -1.47365906e-20,  5.59632158e-20,
         -3.65118334e-03, -5.12432497e-04, -7.36331869e-04,
          1.28512895e-22, -4.87773164e-22,  3.17864596e-05,
          4.44161464e-06,  2.03875360e-01,  5.48848492e-36,
          3.82622593e-36,  1.76004154e-03,  6.04415327e-04,
          8.41156033e-02,  1.00914865e-19, -7.51677453e-20,
          1.37452742e-02,  3.90728924e-03,  4.16825421e-01,
          6.25895390e-19, -4.83714878e-19,  9.22318902e-02,
          2.65187677e-02,  1.24953471e-01, -7.70491898e-19,
          3.73088106e-19, -2.48767415e-02, -3.62434268e-03,
         -1.08896329e-03,  6.71920304e-21, -3.25182109e-21,
          2.16571853e-04,  3.14147398e-05,  4.26402146e-01,
         -4.13967457e-35,  3.84789376e-35,  1.69589035e-02,
          6.04565077e-03,  4.45906730e-01,  2.45884125e-34,
          1.94995810e-34,  8.17038695e-02,  3.02357432e-02,
          4.33834945e-02, -7.45555111e-20,  0.00000000e+00,
         -1.26191930e-03,  1.29860899e-03,  2.14982032e-01,
         -4.62409089e-19,  0.00000000e+00, -8.46757956e-03,
          8.81365775e-03,  6.44460481e-02,  5.69236429e-19,
          0.00000000e+00,  2.28387153e-03, -1.20457015e-03,
         -5.61644108e-04, -4.96412117e-21,  0.00000000e+00,
         -1.98829211e-05,  1.04408609e-05,  2.19921327e-01,
          2.48380474e-35,  0.00000000e+00, -1.55695459e-03,
          2.00930516e-03,  3.25242276e-01, -1.98704379e-34,
          0.00000000e+00, -1.06080559e-02,  1.42114532e-02,
          1.18615095e-01,  9.36701427e-35,  0.00000000e+00,
          6.88650677e-04,  3.33984519e-03, -3.83810815e-04,
         -4.11864902e-22,  0.00000000e+00,  1.02843963e-05,
         -1.19092324e-05, -1.90193137e-03, -2.55447346e-21,
          0.00000000e+00,  6.90091227e-05, -8.08279470e-05,
         -5.70149790e-04,  3.14461671e-21,  0.00000000e+00,
         -1.86131077e-05,  1.10468247e-05,  4.96882710e-06,
         -2.74231542e-23,  0.00000000e+00,  1.62041931e-07,
         -9.57506379e-08, -1.94562897e-03, -6.46824151e-38,
          0.00000000e+00,  1.26888764e-05, -1.84268570e-05,
         -2.87739622e-03, -2.58729661e-37,  0.00000000e+00,
          8.64535876e-05, -1.30329838e-04, -1.48404693e-03,
          0.00000000e+00,  0.00000000e+00, -7.93708802e-06,
         -4.33158359e-05,  9.28379014e-06,  2.85858590e-39,
          0.00000000e+00,  4.57397113e-08,  2.80890511e-07,
          0.00000000e+00],
        [ 1.34720454e-01,  3.57856518e-37,  0.00000000e+00,
          1.46420052e-38,  2.03632423e-05,  1.06278297e-01,
         -4.04868433e-36,  0.00000000e+00,  0.00000000e+00,
          2.36581370e-04,  4.19204209e-02,  2.29028172e-35,
          0.00000000e+00,  0.00000000e+00,  1.37430827e-03,
          1.50508233e-01, -8.09736866e-36,  0.00000000e+00,
          0.00000000e+00,  4.45033074e-04,  8.39568827e-02,
          6.47789493e-35,  0.00000000e+00,  0.00000000e+00,
          3.65603970e-03,  8.40730842e-02,  9.16112686e-35,
          0.00000000e+00,  0.00000000e+00,  4.86303788e-03,
         -1.35228100e-03,  0.00000000e+00,  0.00000000e+00,
         -2.58836529e-39, -3.99552495e-06, -7.54332803e-04,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         -3.28240724e-05, -1.06826418e-03,  0.00000000e+00,
          0.00000000e+00,  0.00000000e+00, -6.17453431e-05,
          6.78688293e-06,  0.00000000e+00,  0.00000000e+00,
          2.28781331e-40,  3.91986192e-07,  2.00950566e-01,
          4.11924746e-22,  0.00000000e+00, -3.84126054e-22,
          1.30421263e-04,  1.12094752e-01, -3.29539797e-21,
          0.00000000e+00,  0.00000000e+00,  1.07143793e-03,
          1.58745329e-01, -6.59079594e-21,  0.00000000e+00,
          0.00000000e+00,  2.01548125e-03, -1.42628936e-03,
          0.00000000e+00,  0.00000000e+00,  4.80157567e-23,
         -1.80950722e-05,  1.49870078e-01,  7.11243144e-07,
          1.12635733e-04,  1.07652759e-03,  7.04346138e-04,
          3.47404712e-01,  3.28430648e-21,  0.00000000e+00,
         -2.41649032e-21,  9.17093910e-04,  1.93790174e-01,
         -2.62744518e-20,  0.00000000e+00,  0.00000000e+00,
          7.53411811e-03,  2.74440009e-01, -5.25489037e-20,
          0.00000000e+00,  0.00000000e+00,  1.41724251e-02,
         -2.46577880e-03,  0.00000000e+00,  0.00000000e+00,
          3.02061290e-22, -1.27240606e-04,  3.66417663e-01,
          8.01971408e-06,  9.91353760e-04,  1.02330417e-02,
          6.94565309e-03,  4.47927652e-01,  4.52136618e-05,
          4.36265763e-03,  4.86433700e-02,  3.42495756e-02,
          1.93671878e-01,  5.22157942e-21,  0.00000000e+00,
          2.54222258e-21,  2.45197193e-04,  1.08034536e-01,
         -4.17726353e-20,  0.00000000e+00,  0.00000000e+00,
          2.01434618e-03,  1.52995369e-01, -8.35452707e-20,
          0.00000000e+00,  0.00000000e+00,  3.78918540e-03,
         -1.37462733e-03,  0.00000000e+00,  0.00000000e+00,
         -3.17777822e-22, -3.40194599e-05,  2.04271257e-01,
          1.27502029e-05, -1.17720223e-03, -2.55642308e-03,
          1.19971756e-03,  3.53145545e-01,  1.01658311e-04,
         -7.32636496e-03, -1.70569805e-02,  8.42323469e-03,
          1.39209731e-01,  1.14284176e-04,  6.15171165e-03,
          4.05692441e-03,  1.49012558e-03, -1.71209069e-03,
         -4.86612597e-23,  0.00000000e+00, -2.15448032e-23,
         -2.19673721e-06, -9.55042755e-04,  3.89290077e-22,
          0.00000000e+00,  0.00000000e+00, -1.80466553e-05,
         -1.35250378e-03,  7.78580154e-22,  0.00000000e+00,
          0.00000000e+00, -3.39475525e-05,  1.21519277e-05,
          0.00000000e+00,  0.00000000e+00,  2.69310040e-24,
          3.04782500e-07, -1.80579091e-03, -1.18822464e-07,
          1.06142749e-05,  2.18665850e-05, -1.05402991e-05,
         -3.12186367e-03, -9.47380299e-07,  6.60583623e-05,
          1.45911651e-04, -7.40314642e-05, -1.74038285e-03,
         -1.50619971e-06, -7.84422824e-05, -4.89224426e-05,
         -1.88341316e-05,  1.08790256e-05,  9.92542292e-09,
          5.00120293e-07,  2.94986335e-07,  1.19099825e-07,
          0.00000000e+00]]),
 &#39;has_data&#39;: array([1, 1, 1])}
</pre></div></div>
</div>
<p>Note that the same descriptor can be obtained not via python, but from the unix command line, using the <code class="docutils literal notranslate"><span class="pre">quip</span></code> program. The input needs to be an extended XYZ file, and the descriptor specification is identical to the above.</p>
<p>So let’s write out an xyz file:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;diamondH.xyz&quot;</span><span class="p">,</span> <span class="n">at</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The following command will print all the descriptor vectors, each vector on a line, which starts with the string <code class="docutils literal notranslate"><span class="pre">DESC</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">quip</span> <span class="pre">atoms_filename=diamondH.xyz</span> <span class="pre">descriptor_str=&quot;soap</span> <span class="pre">cutoff=3</span> <span class="pre">l_max=4</span> <span class="pre">n_max=4</span> <span class="pre">atom_sigma=0.5</span> <span class="pre">n_Z=2</span> <span class="pre">Z={1</span> <span class="pre">6}</span> <span class="pre">n_species=2</span> <span class="pre">species_Z={1</span> <span class="pre">6}&quot;</span></code></p>
</section>
<section id="General_monomer-example:-benzene">
<h2>General_monomer example: benzene<a class="headerlink" href="#General_monomer-example:-benzene" title="Permalink to this heading"></a></h2>
<p>Now for a more interesting descriptor: a three-site benzene monomer</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc_monomer</span> <span class="o">=</span> <span class="n">descriptors</span><span class="o">.</span><span class="n">Descriptor</span><span class="p">(</span><span class="s1">&#39;general_monomer signature={6 6 6} atom_ordercheck=F&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Three intramolecular distances = dimensionality 3:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc_monomer</span><span class="o">.</span><span class="n">n_dim</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3
</pre></div></div>
</div>
<p>And a lot more permutations now:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc_monomer</span><span class="o">.</span><span class="n">n_perm</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
6
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">desc_monomer</span><span class="o">.</span><span class="n">permutations</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[1, 2, 3],
       [2, 1, 3],
       [1, 3, 2],
       [3, 1, 2],
       [2, 3, 1],
       [3, 2, 1]], dtype=int32)
</pre></div></div>
</div>
<p>Load some test configurations</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">benzat</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;benzene_frames.xyz&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">benzat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
40
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">benzat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(648, 3)
</pre></div></div>
</div>
<p>Calling <code class="docutils literal notranslate"><span class="pre">calc</span></code> or any of the other methods on a list of <code class="docutils literal notranslate"><span class="pre">Atoms</span></code> objects returns a list of results. Here we look at the results for the first configuration:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">desc_monomer</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">benzat</span><span class="p">,</span> <span class="n">grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;grad_data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(648, 3, 3)
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quippy-potential-tutorial.html" class="btn btn-neutral float-left" title="Using QUIP potentials with Atomic Simulation Environment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gap_fitting_tutorial.html" class="btn btn-neutral float-right" title="Training a GAP model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2022, Albert Bartok-Partay, Noam Bernstein, Gabor Csanyi and James Kermode.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>